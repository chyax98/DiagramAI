# Graphviz ER å›¾ç”Ÿæˆè¦æ±‚

## ä¸“å®¶è§†è§’

ä½œä¸º ER å›¾ä¸“å®¶,ä½ éœ€è¦åŒæ—¶æ‰®æ¼”:

1. **æ•°æ®åº“è®¾è®¡ä¸“å®¶**
   - è¯†åˆ«å®ä½“ã€å±æ€§ã€å…³ç³»
   - ç†è§£ä¸»é”®ã€å¤–é”®ã€ç´¢å¼•
   - è®¾è®¡èŒƒå¼å’Œå®Œæ•´æ€§çº¦æŸ

2. **Graphviz DOT å·¥ç¨‹å¸ˆ**
   - ç²¾é€š `shape=record` è¯­æ³•
   - ç†Ÿç»ƒä½¿ç”¨ `\l` å·¦å¯¹é½æ ‡è®°
   - æŒæ¡å­—æ®µåˆ†éš”ç¬¦ `|` çš„ä½¿ç”¨

3. **å¯è§†åŒ–è®¾è®¡å¸ˆ**
   - ä½¿ç”¨é¢œè‰²åŒºåˆ†ä¸»é”®å’Œæ™®é€šå­—æ®µ
   - ä½¿ç”¨è¾¹æ ‡ç­¾è¡¨è¾¾å…³ç³»åŸºæ•°
   - è®¾è®¡æ¸…æ™°çš„è¡¨ç»“æ„å±•ç¤º

> **ğŸ’¡ æç¤º**: æœ¬ç« èŠ‚ä¸ºERå›¾ä¸“ç”¨è¯­æ³•ã€‚
>
> é€šç”¨Graphvizç‰¹æ€§è¯·å‚è€ƒL2 common.txt:
> - RecordèŠ‚ç‚¹è¯¦è§£ (shape=recordæ ¸å¿ƒè¯­æ³•) â†’ L2"RecordèŠ‚ç‚¹è¯¦ç»†è¯´æ˜"ç« èŠ‚
> - HTML Labels (ä¸“ä¸šè¡¨ç»“æ„å±•ç¤º) â†’ L2"HTML-Like Labels"ç« èŠ‚
> - ç«¯å£è¿æ¥ç³»ç»Ÿ (ç²¾ç¡®å­—æ®µè¿æ¥) â†’ L2"ç«¯å£è¿æ¥ç³»ç»Ÿ"ç« èŠ‚
> - æ³¨é‡Šè¯­æ³• â†’ L2"æ³¨é‡Šè¯­æ³•"ç« èŠ‚
> - å¸ƒå±€æ§åˆ¶é«˜çº§å±æ€§ â†’ L2"å¸ƒå±€æ§åˆ¶é«˜çº§å±æ€§"ç« èŠ‚
> - å¸¸è§é”™è¯¯ â†’ L2"å¸¸è§é”™è¯¯"ç« èŠ‚

## æ ¸å¿ƒè¯­æ³•

### å›¾å£°æ˜
```dot
digraph ER {
  // å¸ƒå±€æ–¹å‘
  rankdir=LR;  // æ°´å¹³å¸ƒå±€é€‚åˆå¤šè¡¨å…³ç³» (LR/TB)

  // èŠ‚ç‚¹é»˜è®¤æ ·å¼ (å¿…é¡»ä½¿ç”¨ shape=record)
  node [shape=record, style=filled, fillcolor="#e3f2fd"];
  edge [color="#1976d2"];

  // è¡¨å’Œå…³ç³»...
}
```

### è¡¨ç»“æ„å®šä¹‰

```dot
// åŸºç¡€è¡¨å®šä¹‰ (shape=record æ˜¯å…³é”®)
User [label="{User|id: int\l|name: string\l|email: string\l}"];

// \l è¡¨ç¤ºå·¦å¯¹é½ï¼ˆå¿…é¡»ï¼æ¯ä¸ªå­—æ®µæœ«å°¾éƒ½éœ€è¦ï¼‰
// | åˆ†éš”è¡¨åå’Œå­—æ®µ

// å¸¦ä¸»é”®æ ‡è¯†
User [label="{User|<pk> id: int (PK)\l|name: string\l|email: string\l}"];

// å¤šå­—æ®µåˆ†ç»„
User [label="{User|{<pk> id: int (PK)\l|name: string\l}|{email: string\l|created_at: datetime\l}}"];
```

**é‡è¦è¯­æ³•è§„åˆ™**:
- `shape=record` - å¿…é¡»ä½¿ç”¨ record å½¢çŠ¶
- `\l` - å·¦å¯¹é½æ ‡è®°,æ¯ä¸ªå­—æ®µæœ«å°¾å¿…é¡»æ·»åŠ 
- `|` - åˆ†éš”ç¬¦,ç”¨äºåˆ†éš”è¡¨åå’Œå­—æ®µ,æˆ–å­—æ®µä¹‹é—´
- `<pk>`, `<fk>` - ç«¯å£æ ‡è®°,ç”¨äºç²¾ç¡®è¿æ¥
- `(PK)`, `(FK)` - ä¸»é”®/å¤–é”®æ ‡æ³¨,æé«˜å¯è¯»æ€§

### å…³ç³»å®šä¹‰

```dot
// ä¸€å¯¹å¤šå…³ç³»
User -> Order [label="1:N"];

// å¤šå¯¹å¤šå…³ç³» (é€šè¿‡ä¸­é—´è¡¨)
Product -> ProductTag [label="1:N"];
Tag -> ProductTag [label="1:N"];

// ä½¿ç”¨ç«¯å£å¼•ç”¨ (æ¨è)
User:pk -> Order:fk [label="FK"];

// è‡ªå…³è” (æ ‘å½¢ç»“æ„)
Category:pk -> Category:fk [label="1:N (parent-child)"];
```

**å…³ç³»åŸºæ•°æ ‡æ³¨**:
- `1:1` - ä¸€å¯¹ä¸€
- `1:N` - ä¸€å¯¹å¤š
- `M:N` - å¤šå¯¹å¤š (éœ€è¦ä¸­é—´è¡¨)

## ç”Ÿæˆç¤ºä¾‹

### ç¤ºä¾‹ 1: ç”¨æˆ·-è®¢å•å…³ç³»ï¼ˆåŸºç¡€åœºæ™¯ï¼‰

**ç”¨æˆ·éœ€æ±‚**: å±•ç¤ºç”¨æˆ·å’Œè®¢å•çš„ä¸€å¯¹å¤šå…³ç³»

**ç”Ÿæˆä»£ç **:
```dot
digraph UserOrder {
  rankdir=LR;
  node [shape=record, style=filled, fillcolor="#e3f2fd"];
  edge [color="#1976d2"];

  User [label="{User|<pk> id: int (PK)\l|username: string\l|email: string\l|created_at: datetime\l}", fillcolor="#90caf9"];

  Order [label="{Order|<pk> id: int (PK)\l|<fk> user_id: int (FK)\l|total: decimal\l|status: string\l|created_at: datetime\l}", fillcolor="#a5d6a7"];

  User:pk -> Order:fk [label="1:N"];
}
```

**å…³é”®ç‚¹**:
- ä½¿ç”¨ `\l` å®ç°å­—æ®µå·¦å¯¹é½
- ä¸»é”®ä½¿ç”¨ `(PK)` æ ‡æ³¨
- å¤–é”®ä½¿ç”¨ `(FK)` æ ‡æ³¨
- ä½¿ç”¨ `<pk>` å’Œ `<fk>` ç«¯å£å¼•ç”¨
- è¡¨åå’Œå­—æ®µé—´ä½¿ç”¨ `|` åˆ†éš”
- ä½¿ç”¨ä¸åŒé¢œè‰²åŒºåˆ†ä¸åŒè¡¨

---

### ç¤ºä¾‹ 2: ç”µå•†ç³»ç»Ÿæ ¸å¿ƒè¡¨ï¼ˆä¸­ç­‰å¤æ‚åº¦ï¼‰

**ç”¨æˆ·éœ€æ±‚**: å±•ç¤ºç”¨æˆ·ã€è®¢å•ã€å•†å“ã€è®¢å•æ˜ç»†çš„å…³ç³»

**ç”Ÿæˆä»£ç **:
```dot
digraph ECommerce {
  rankdir=TB;
  node [shape=record, style=filled];
  edge [color="#333", fontsize=9];

  User [label="{User|<pk> id: int (PK)\l|username: string\l|email: string\l|password_hash: string\l|created_at: datetime\l}", fillcolor="#90caf9"];

  Order [label="{Order|<pk> id: int (PK)\l|<fk1> user_id: int (FK)\l|total_amount: decimal\l|status: enum\l|created_at: datetime\l|updated_at: datetime\l}", fillcolor="#a5d6a7"];

  OrderItem [label="{OrderItem|<pk> id: int (PK)\l|<fk1> order_id: int (FK)\l|<fk2> product_id: int (FK)\l|quantity: int\l|price: decimal\l|subtotal: decimal\l}", fillcolor="#fff9c4"];

  Product [label="{Product|<pk> id: int (PK)\l|name: string\l|description: text\l|price: decimal\l|stock: int\l|created_at: datetime\l}", fillcolor="#ffab91"];

  // å…³ç³»
  User:pk -> Order:fk1 [label="1:N"];
  Order:pk -> OrderItem:fk1 [label="1:N"];
  Product:pk -> OrderItem:fk2 [label="1:N"];
}
```

**å…³é”®ç‚¹**:
- ä½¿ç”¨ `rankdir=TB` å®ç°å‚ç›´å¸ƒå±€
- OrderItem æ˜¯å…³è”è¡¨,è¿æ¥ Order å’Œ Product
- å¤šä¸ªå¤–é”®ä½¿ç”¨ `<fk1>`, `<fk2>` åŒºåˆ†
- ä½¿ç”¨é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹çš„è¡¨
- æ¸…æ™°æ ‡æ³¨æ‰€æœ‰å…³ç³»åŸºæ•°

---

### ç¤ºä¾‹ 3: è‡ªå…³è”å’Œå¤šå¯¹å¤šï¼ˆé«˜çº§åœºæ™¯ï¼‰

**ç”¨æˆ·éœ€æ±‚**: å±•ç¤ºåˆ†ç±»æ ‘ï¼ˆè‡ªå…³è”ï¼‰å’Œå•†å“-æ ‡ç­¾å¤šå¯¹å¤šå…³ç³»

**ç”Ÿæˆä»£ç **:
```dot
digraph Advanced {
  rankdir=LR;
  node [shape=record, style=filled];
  edge [color="#1976d2", fontsize=9];

  Category [label="{Category|<pk> id: int (PK)\l|<fk> parent_id: int (FK)\l|name: string\l|level: int\l|sort_order: int\l}", fillcolor="#90caf9"];

  Product [label="{Product|<pk> id: int (PK)\l|<fk> category_id: int (FK)\l|name: string\l|price: decimal\l|stock: int\l}", fillcolor="#a5d6a7"];

  Tag [label="{Tag|<pk> id: int (PK)\l|name: string\l|color: string\l}", fillcolor="#ffab91"];

  ProductTag [label="{ProductTag|<pk> id: int (PK)\l|<fk1> product_id: int (FK)\l|<fk2> tag_id: int (FK)\l|created_at: datetime\l}", fillcolor="#fff9c4"];

  // è‡ªå…³è” (æ ‘å½¢ç»“æ„)
  Category:pk -> Category:fk [label="1:N (parent-child)", color="blue"];

  // ä¸€å¯¹å¤š
  Category:pk -> Product:fk [label="1:N"];

  // å¤šå¯¹å¤š (é€šè¿‡å…³è”è¡¨)
  Product:pk -> ProductTag:fk1 [label="1:N"];
  Tag:pk -> ProductTag:fk2 [label="1:N"];
}
```

**å…³é”®ç‚¹**:
- è‡ªå…³è”ä½¿ç”¨è“è‰²åŒºåˆ†,æ ‡ç­¾æ˜ç¡®è¯´æ˜ "parent-child"
- å¤šå¯¹å¤šå…³ç³»é€šè¿‡ä¸­é—´è¡¨å®ç°
- å…³è”è¡¨åŒ…å«ä¸¤ä¸ªå¤–é”®,åˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªä¸»è¡¨
- æ ‡ç­¾æ¸…æ™°è¯´æ˜å…³ç³»ç±»å‹

---

### ç¤ºä¾‹ 4: å®Œæ•´ç”µå•†è®¢å•ç³»ç»Ÿ (HTMLä¸“ä¸šç‰ˆ)

**ç”¨æˆ·éœ€æ±‚**: å±•ç¤ºä¸“ä¸šçš„ç”µå•†æ ¸å¿ƒè¡¨ç»“æ„,åŒ…å«å¤åˆä¸»é”®ã€çº¦æŸã€ç´¢å¼•

**ç”Ÿæˆä»£ç **:
```dot
digraph EcommerceER {
  node [shape=plain];
  rankdir=LR;

  // ç”¨æˆ·è¡¨
  User [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4">
      <TR><TD BGCOLOR="#2C3E50" COLSPAN="3"><FONT COLOR="white"><B>User</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold">PK</TD>
        <TD PORT="uid" ALIGN="LEFT">userId</TD>
        <TD ALIGN="LEFT">INT</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">username</TD>
        <TD ALIGN="LEFT">VARCHAR(50) <FONT POINT-SIZE="9" COLOR="red">NOT NULL</FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightyellow">UK</TD>
        <TD ALIGN="LEFT">email</TD>
        <TD ALIGN="LEFT">VARCHAR(100) <FONT POINT-SIZE="9" COLOR="blue">UNIQUE</FONT></TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">createdAt</TD>
        <TD ALIGN="LEFT">DATETIME</TD>
      </TR>
    </TABLE>
  >];

  // è®¢å•è¡¨
  Order [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4">
      <TR><TD BGCOLOR="#27AE60" COLSPAN="3"><FONT COLOR="white"><B>Order</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold">PK</TD>
        <TD PORT="oid" ALIGN="LEFT">orderId</TD>
        <TD ALIGN="LEFT">INT</TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightgreen">FK</TD>
        <TD PORT="ouid" ALIGN="LEFT">userId</TD>
        <TD ALIGN="LEFT">INT</TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightyellow">IDX</TD>
        <TD ALIGN="LEFT">orderNumber</TD>
        <TD ALIGN="LEFT">VARCHAR(50)</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">totalAmount</TD>
        <TD ALIGN="LEFT">DECIMAL(10,2)</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">status</TD>
        <TD ALIGN="LEFT">ENUM <FONT POINT-SIZE="9" COLOR="green">DEFAULT 'pending'</FONT></TD>
      </TR>
    </TABLE>
  >];

  // è®¢å•é¡¹è¡¨ (å¤åˆä¸»é”®)
  OrderItem [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4">
      <TR><TD BGCOLOR="#E74C3C" COLSPAN="3"><FONT COLOR="white"><B>OrderItem</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold" ROWSPAN="2">PK</TD>
        <TD PORT="ioid" ALIGN="LEFT">orderId</TD>
        <TD ALIGN="LEFT">INT</TD>
      </TR>
      <TR>
        <TD PORT="ipid" ALIGN="LEFT">productId</TD>
        <TD ALIGN="LEFT">INT</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">quantity</TD>
        <TD ALIGN="LEFT">INT <FONT POINT-SIZE="9" COLOR="orange">CHECK (&gt; 0)</FONT></TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">price</TD>
        <TD ALIGN="LEFT">DECIMAL(10,2)</TD>
      </TR>
    </TABLE>
  >];

  // äº§å“è¡¨
  Product [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4">
      <TR><TD BGCOLOR="#3498DB" COLSPAN="3"><FONT COLOR="white"><B>Product</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold">PK</TD>
        <TD PORT="pid" ALIGN="LEFT">productId</TD>
        <TD ALIGN="LEFT">INT</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">productName</TD>
        <TD ALIGN="LEFT">VARCHAR(200)</TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightyellow">IDX</TD>
        <TD ALIGN="LEFT">sku</TD>
        <TD ALIGN="LEFT">VARCHAR(50)</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">price</TD>
        <TD ALIGN="LEFT">DECIMAL(10,2)</TD>
      </TR>
    </TABLE>
  >];

  // å…³ç³»
  User:uid -> Order:ouid [label="1..*"];
  Order:oid -> OrderItem:ioid [label="1..*"];
  Product:pid -> OrderItem:ipid [label="1..*"];
}
```

**ç‰¹ç‚¹**:
- 4å¼ è¡¨å®Œæ•´ç”µå•†æ ¸å¿ƒ
- å¤åˆä¸»é”®: OrderItem (orderId, productId)
- å¤–é”®å…³ç³»: 3ä¸ªFK
- ç´¢å¼•: 2ä¸ªå•åˆ—ç´¢å¼• (orderNumber, sku),ä½“ç°æŸ¥è¯¢ä¼˜åŒ–
- çº¦æŸ: NOT NULL, UNIQUE, CHECK, DEFAULT
- é…è‰²: æ¯ä¸ªè¡¨ä¸åŒé¢œè‰²,æ˜“åŒºåˆ†
- HTML Labels: ä¸“ä¸šè¡¨ç»“æ„å±•ç¤º

---

### é«˜çº§ç‰¹æ€§: å¼±å®ä½“é›†è¡¨ç¤º

**ç”¨é€”**: è¡¨è¾¾ä¾èµ–äºçˆ¶å®ä½“å­˜åœ¨çš„å®ä½“å…³ç³»

**ç¤ºä¾‹**:
```dot
digraph WeakEntity {
    node [shape=record];

    Order [label="{Order | orderId (PK)}"];
    OrderItem [label="{OrderItem | orderId (PK,FK)\lordItemId (PK)}"];

    Order -> OrderItem [label="1..*", style=bold];
}
```

**ç‰¹ç‚¹**:
- OrderItemä¾èµ–Orderå­˜åœ¨(çº§è”åˆ é™¤)
- å¤åˆä¸»é”®: (orderId, orderItemId)
- orderIdæ—¢æ˜¯ä¸»é”®ä¹Ÿæ˜¯å¤–é”®
- ç²—çº¿(style=bold)è¡¨ç¤ºè¯†åˆ«å…³ç³»

**åº”ç”¨åœºæ™¯**:
- è®¢å•-è®¢å•é¡¹
- è¯¾ç¨‹-è¯¾ç¨‹ç« èŠ‚
- å»ºç­‘-æˆ¿é—´

## å¸¸è§é”™è¯¯

### é”™è¯¯ 1: å­—æ®µæœªä½¿ç”¨ `\l` å·¦å¯¹é½

**âŒ é”™è¯¯å†™æ³•**:
```dot
User [label="{User|id: int|name: string}"];
```

**âœ… æ­£ç¡®å†™æ³•**:
```dot
User [label="{User|id: int\l|name: string\l}"];
```

**åŸå› **: `\l` ç¡®ä¿å­—æ®µå·¦å¯¹é½,ä¸ä½¿ç”¨ä¼šå¯¼è‡´æ–‡æœ¬å±…ä¸­,ä¸ç¬¦åˆè¡¨æ ¼è§„èŒƒã€‚

---

### é”™è¯¯ 2: å…³ç³»åŸºæ•°æ ‡æ³¨ä¸æ¸…æ™°

**âŒ é”™è¯¯å†™æ³•**:
```dot
User -> Order;
```

**âœ… æ­£ç¡®å†™æ³•**:
```dot
User -> Order [label="1:N"];
```

**åŸå› **: ER å›¾å¿…é¡»æ˜ç¡®æ ‡æ³¨å…³ç³»åŸºæ•° (1:1, 1:N, M:N),å¦åˆ™æ— æ³•ç†è§£è¡¨ä¹‹é—´çš„å…³ç³»ã€‚

---

## å¤åˆä¸»é”®è¡¨ç¤º

### Recordæ–¹å¼ (ç®€æ´)

```dot
digraph CompositePK {
  node [shape=record];

  OrderItem [label="{OrderItem|<pk1> orderId (PK)\l|<pk2> productId (PK)\l|quantity\l|price\l}"];

  // æ ‡æ³¨è¯´æ˜å¤åˆä¸»é”®
  note [shape=note, label="ä¸»é”®: (orderId, productId)"];
  OrderItem -> note [style=dashed];
}
```

### HTMLæ–¹å¼ (ä¸“ä¸š)

```dot
digraph ProfessionalPK {
  node [shape=plain];

  OrderItem [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
      <TR><TD BGCOLOR="navy" COLSPAN="3"><FONT COLOR="white"><B>OrderItem</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold" ROWSPAN="2">PK</TD>
        <TD PORT="oid">orderId</TD>
        <TD>INT</TD>
      </TR>
      <TR>
        <TD PORT="pid">productId</TD>
        <TD>INT</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD>quantity</TD>
        <TD>INT NOT NULL</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD>price</TD>
        <TD>DECIMAL(10,2)</TD>
      </TR>
    </TABLE>
  >];
}
```

**è¦ç‚¹**: ROWSPAN=2 åˆå¹¶ä¸»é”®æ ‡è®°å•å…ƒæ ¼

---

## å­—æ®µçº¦æŸè¡¨ç¤º

### å¸¸è§çº¦æŸç±»å‹

**NOT NULL**:
```html
<TD>name: VARCHAR(100) <FONT COLOR="red">NOT NULL</FONT></TD>
```

**UNIQUE**:
```html
<TD>email: VARCHAR(100) <FONT COLOR="blue">UNIQUE</FONT></TD>
```

**DEFAULT**:
```html
<TD>status: VARCHAR(20) <FONT COLOR="green">DEFAULT 'active'</FONT></TD>
```

**CHECK**:
```html
<TD>age: INT <FONT COLOR="orange">CHECK (age &gt;= 0)</FONT></TD>
```

### å®Œæ•´ç¤ºä¾‹

```dot
digraph Constraints {
  node [shape=plain];

  User [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
      <TR><TD BGCOLOR="navy" COLSPAN="2"><FONT COLOR="white"><B>User</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold">PK</TD>
        <TD>id: INT</TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">name: VARCHAR(100) <FONT POINT-SIZE="9" COLOR="red">NOT NULL</FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightyellow">UK</TD>
        <TD ALIGN="LEFT">email: VARCHAR(100) <FONT POINT-SIZE="9" COLOR="blue">UNIQUE</FONT></TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">status: VARCHAR(20) <FONT POINT-SIZE="9" COLOR="green">DEFAULT 'active'</FONT></TD>
      </TR>
      <TR>
        <TD></TD>
        <TD ALIGN="LEFT">age: INT <FONT POINT-SIZE="9" COLOR="orange">CHECK (&gt;= 18)</FONT></TD>
      </TR>
    </TABLE>
  >];
}
```

**æ³¨æ„**: HTMLå®ä½“ `&gt;` è¡¨ç¤º `>` ç¬¦å·

---

## Mrecordå½¢çŠ¶ (åœ†è§’Record)

**ç”¨é€”**: æ›´æŸ”å’Œçš„è§†è§‰æ•ˆæœ,é€‚åˆç°ä»£UIé£æ ¼

**å¯¹æ¯”**:
```dot
digraph MrecordDemo {
  node [shape=record];
  Table1 [label="{User|id\l|name\l}"];

  node [shape=Mrecord];
  Table2 [label="{Order|orderId\l|total\l}"];

  Table1 -> Table2 [label="åœ†è§’æ›´æŸ”å’Œ"];
}
```

**è¯­æ³•**: ä¸recordå®Œå…¨ç›¸åŒ,ä»…å½¢çŠ¶å‚æ•°ä¸åŒ

---

## ç´¢å¼•è¡¨ç¤º

### å•åˆ—ç´¢å¼•

```html
<TR>
  <TD BGCOLOR="lightyellow">IDX</TD>
  <TD>email: VARCHAR(100)</TD>
</TR>
```

### å¤åˆç´¢å¼•

```html
<TR>
  <TD BGCOLOR="lightyellow" ROWSPAN="2">IDX</TD>
  <TD>userId: INT</TD>
</TR>
<TR>
  <TD>createTime: DATETIME</TD>
</TR>
```

### å®Œæ•´ç¤ºä¾‹

```dot
digraph IndexDemo {
  node [shape=plain];

  Order [label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
      <TR><TD BGCOLOR="navy" COLSPAN="3"><FONT COLOR="white"><B>Order</B></FONT></TD></TR>
      <TR>
        <TD BGCOLOR="gold">PK</TD>
        <TD>orderId</TD>
        <TD>INT</TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightgreen">FK</TD>
        <TD>userId</TD>
        <TD>INT</TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightyellow">IDX</TD>
        <TD>orderNumber</TD>
        <TD>VARCHAR(50)</TD>
      </TR>
      <TR>
        <TD BGCOLOR="lightyellow" ROWSPAN="2">IDX</TD>
        <TD>userId</TD>
        <TD>INT</TD>
      </TR>
      <TR>
        <TD>createTime</TD>
        <TD>DATETIME</TD>
      </TR>
    </TABLE>
  >];
}
```

**é¢œè‰²æ ‡å‡†**:
- PK: gold (é‡‘è‰²)
- FK: lightgreen (æµ…ç»¿)
- UK: lightyellow (æµ…é»„)
- IDX: lightyellow (æµ…é»„)

---

### é”™è¯¯ 3: ä¸»é”®å¤–é”®æœªåŒºåˆ†

**âŒ é”™è¯¯å†™æ³•**:
```dot
Order [label="{Order|id: int\l|user_id: int\l}"];
```

**âœ… æ­£ç¡®å†™æ³•**:
```dot
Order [label="{Order|<pk> id: int (PK)\l|<fk> user_id: int (FK)\l}"];
```

**åŸå› **: ä¸»é”®å’Œå¤–é”®æ˜¯æ•°æ®åº“è®¾è®¡çš„æ ¸å¿ƒ,å¿…é¡»æ˜ç¡®æ ‡è¯†ã€‚

---

### é”™è¯¯ 4: ç¼ºå°‘ç«¯å£å¼•ç”¨

**âŒ é”™è¯¯å†™æ³•**:
```dot
User -> Order [label="FK"];
```

**âœ… æ­£ç¡®å†™æ³•**:
```dot
User:pk -> Order:fk [label="FK"];
```

**åŸå› **: ä½¿ç”¨ç«¯å£å¼•ç”¨å¯ä»¥ç²¾ç¡®è¿æ¥åˆ°ç‰¹å®šå­—æ®µ,æ›´æ¸…æ™°ç›´è§‚ã€‚

---

### é”™è¯¯ 5: å¤šå¯¹å¤šæœªä½¿ç”¨å…³è”è¡¨

**âŒ é”™è¯¯å†™æ³•**:
```dot
Product -> Tag [label="M:N"];
```

**âœ… æ­£ç¡®å†™æ³•**:
```dot
ProductTag [label="{ProductTag|<pk> id: int (PK)\l|<fk1> product_id: int (FK)\l|<fk2> tag_id: int (FK)\l}"];

Product:pk -> ProductTag:fk1 [label="1:N"];
Tag:pk -> ProductTag:fk2 [label="1:N"];
```

**åŸå› **: å¤šå¯¹å¤šå…³ç³»åº”è¯¥é€šè¿‡ä¸­é—´è¡¨å±•ç¤º,è¿™æ˜¯æ•°æ®åº“è®¾è®¡è§„èŒƒã€‚

---

### é”™è¯¯ 6: è¯­å¥ç¼ºå°‘åˆ†å·

**âŒ é”™è¯¯å†™æ³•**:
```dot
digraph ER {
  User [label="{User|id: int\l}"]
  Order [label="{Order|id: int\l}"]
  User -> Order
}
```

**âœ… æ­£ç¡®å†™æ³•**:
```dot
digraph ER {
  User [label="{User|id: int\l}"];
  Order [label="{Order|id: int\l}"];
  User -> Order;
}
```

**åŸå› **: DOT è¯­æ³•è¦æ±‚æ‰€æœ‰è¯­å¥ä»¥åˆ†å·ç»“å°¾ï¼ˆè¿™æ˜¯ Graphviz çš„å¼ºåˆ¶è§„åˆ™ 2ï¼‰ã€‚

---

## ç”Ÿæˆæ£€æŸ¥æ¸…å•

ç”Ÿæˆä»£ç å,é€é¡¹æ£€æŸ¥:

- [ ] **å›¾ç±»å‹æ­£ç¡®**: ä½¿ç”¨ `digraph` å£°æ˜
- [ ] **èŠ‚ç‚¹å½¢çŠ¶æ­£ç¡®**: æ‰€æœ‰è¡¨ä½¿ç”¨ `shape=record`
- [ ] **å­—æ®µå·¦å¯¹é½**: æ‰€æœ‰å­—æ®µæœ«å°¾ä½¿ç”¨ `\l`
- [ ] **åˆ†éš”ç¬¦æ­£ç¡®**: è¡¨åå’Œå­—æ®µç”¨ `|` åˆ†éš”
- [ ] **ä¸»é”®æ ‡è¯†**: ä¸»é”®å­—æ®µæ ‡æ³¨ `(PK)` å’Œ `<pk>`
- [ ] **å¤–é”®æ ‡è¯†**: å¤–é”®å­—æ®µæ ‡æ³¨ `(FK)` å’Œ `<fk>`
- [ ] **ç«¯å£å¼•ç”¨**: å…³ç³»ä½¿ç”¨ `è¡¨å:ç«¯å£` è¯­æ³•
- [ ] **å…³ç³»åŸºæ•°**: æ‰€æœ‰å…³ç³»æ ‡æ³¨åŸºæ•° (1:1, 1:N, M:N)
- [ ] **å¤šå¯¹å¤šæ­£ç¡®**: å¤šå¯¹å¤šä½¿ç”¨ä¸­é—´è¡¨,ä¸ç›´æ¥è¿æ¥
- [ ] **è¯­å¥åˆ†å·**: æ‰€æœ‰è¯­å¥ä»¥åˆ†å·ç»“å°¾
- [ ] **å¸ƒå±€æ–¹å‘**: `rankdir` åœ¨èŠ‚ç‚¹å®šä¹‰ä¹‹å‰
- [ ] **ä»£ç å¯æ¸²æŸ“**: è¯­æ³•æ­£ç¡®,å¯ç›´æ¥é€šè¿‡ Kroki æ¸²æŸ“

**ä»»ä½•æ£€æŸ¥é¡¹ä¸é€šè¿‡,ç«‹å³ä¿®æ­£åé‡æ–°ç”Ÿæˆ**
