# BPMN è¯­æ³•è§„åˆ™è¯¦è§£

> **éªŒè¯æ—¶é—´**: 2025-10-13
> **å‚è€ƒæ¥æº**: OMG BPMN 2.0 Specification, bpmn.io Documentation

---

## ğŸ¯ æ ¸å¿ƒè¯­æ³•è§„åˆ™

### 1. XML ç»“æ„è§„åˆ™

#### 1.1 åŸºæœ¬æ–‡æ¡£ç»“æ„

```xml
<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             id="Definitions_1"
             targetNamespace="http://bpmn.io/schema/bpmn">

  <!-- æµç¨‹å®šä¹‰ -->
  <process id="Process_1" isExecutable="false">
    <!-- Flow Objects -->
  </process>

  <!-- å›¾å½¢ä¿¡æ¯ -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <!-- Shapes and Edges -->
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions>
```

#### 1.2 å‘½åç©ºé—´è§„åˆ™

**å¿…éœ€å‘½åç©ºé—´**:
```xml
xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"        <!-- BPMN æ¨¡å‹ -->
xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"    <!-- BPMN å›¾å½¢ -->
```

**å¯é€‰å‘½åç©ºé—´**:
```xml
xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"          <!-- ç»´åº¦åæ ‡ -->
xmlns:di="http://www.omg.org/spec/DD/20100524/DI"          <!-- å›¾å½¢ä¿¡æ¯ -->
xmlns:camunda="http://camunda.org/schema/1.0/bpmn"         <!-- Camunda æ‰©å±• -->
xmlns:modeler="http://camunda.org/schema/modeler/1.0"      <!-- Modeler å…ƒæ•°æ® -->
```

#### 1.3 ID å’Œå¼•ç”¨è§„åˆ™

**ID è§„åˆ™**:
- å¿…é¡»å”¯ä¸€ (æ•´ä¸ªæ–‡æ¡£å†…)
- æ ¼å¼: `[A-Za-z_][A-Za-z0-9_.-]*`
- æ¨è: `ElementType_Number` (å¦‚ `StartEvent_1`)

**å¼•ç”¨è§„åˆ™**:
- `sourceRef`: æŒ‡å‘æºå…ƒç´  ID
- `targetRef`: æŒ‡å‘ç›®æ ‡å…ƒç´  ID
- `bpmnElement`: å›¾å½¢å…ƒç´ æŒ‡å‘æµç¨‹å…ƒç´ 

```xml
<!-- æµç¨‹å…ƒç´  -->
<task id="Task_ProcessOrder" name="å¤„ç†è®¢å•"/>

<!-- é¡ºåºæµå¼•ç”¨ -->
<sequenceFlow id="Flow_1" sourceRef="StartEvent_1" targetRef="Task_ProcessOrder"/>

<!-- å›¾å½¢å…ƒç´ å¼•ç”¨ -->
<bpmndi:BPMNShape id="Shape_Task_ProcessOrder" bpmnElement="Task_ProcessOrder">
  <dc:Bounds x="200" y="100" width="100" height="80"/>
</bpmndi:BPMNShape>
```

### 2. äº‹ä»¶è§„åˆ™

#### 2.1 Start Event (å¼€å§‹äº‹ä»¶)

```xml
<!-- None Start Event -->
<startEvent id="StartEvent_1" name="å¼€å§‹"/>

<!-- Message Start Event -->
<startEvent id="StartEvent_Message" name="æ”¶åˆ°æ¶ˆæ¯">
  <messageEventDefinition messageRef="Message_OrderRequest"/>
</startEvent>

<!-- Timer Start Event -->
<startEvent id="StartEvent_Timer" name="æ¯æ—¥æ‰§è¡Œ">
  <timerEventDefinition>
    <timeCycle>0 0 0 * * ?</timeCycle>  <!-- Cron è¡¨è¾¾å¼ -->
  </timerEventDefinition>
</startEvent>

<!-- Signal Start Event -->
<startEvent id="StartEvent_Signal" name="æ”¶åˆ°ä¿¡å·">
  <signalEventDefinition signalRef="Signal_Alert"/>
</startEvent>

<!-- Conditional Start Event -->
<startEvent id="StartEvent_Conditional" name="æ¡ä»¶è§¦å‘">
  <conditionalEventDefinition>
    <condition>stock &lt; threshold</condition>
  </conditionalEventDefinition>
</startEvent>
```

**è§„åˆ™**:
- âœ… ä¸èƒ½æœ‰ incoming sequence flow
- âœ… å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ª outgoing sequence flow
- âœ… å¯ä»¥æœ‰å¤šä¸ª Start Event (ä¸åŒè§¦å‘æ¡ä»¶)

#### 2.2 End Event (ç»“æŸäº‹ä»¶)

```xml
<!-- None End Event -->
<endEvent id="EndEvent_1" name="ç»“æŸ"/>

<!-- Message End Event -->
<endEvent id="EndEvent_Message" name="å‘é€å“åº”">
  <messageEventDefinition messageRef="Message_OrderConfirmation"/>
</endEvent>

<!-- Error End Event -->
<endEvent id="EndEvent_Error" name="é”™è¯¯ç»“æŸ">
  <errorEventDefinition errorRef="Error_ValidationFailed"/>
</endEvent>

<!-- Terminate End Event -->
<endEvent id="EndEvent_Terminate" name="ç»ˆæ­¢">
  <terminateEventDefinition/>
</endEvent>
```

**è§„åˆ™**:
- âœ… å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ª incoming sequence flow
- âœ… ä¸èƒ½æœ‰ outgoing sequence flow
- âœ… Terminate End ä¼šç«‹å³ç»ˆæ­¢æ‰€æœ‰æ´»åŠ¨æµç¨‹

#### 2.3 Intermediate Event (ä¸­é—´äº‹ä»¶)

```xml
<!-- Timer Intermediate Event (Catching) -->
<intermediateCatchEvent id="IntermediateEvent_Timer" name="ç­‰å¾… 2 å°æ—¶">
  <timerEventDefinition>
    <timeDuration>PT2H</timeDuration>  <!-- ISO 8601 duration -->
  </timerEventDefinition>
</intermediateCatchEvent>

<!-- Message Intermediate Event (Throwing) -->
<intermediateThrowEvent id="IntermediateEvent_SendNotice" name="å‘é€é€šçŸ¥">
  <messageEventDefinition messageRef="Message_Notification"/>
</intermediateThrowEvent>

<!-- Signal Intermediate Event (Catching) -->
<intermediateCatchEvent id="IntermediateEvent_Signal" name="ç­‰å¾…ä¿¡å·">
  <signalEventDefinition signalRef="Signal_Continue"/>
</intermediateCatchEvent>

<!-- Link Events (é¡µé¢è·³è½¬) -->
<intermediateThrowEvent id="ThrowLink_1" name="å»é¡µé¢ 2">
  <linkEventDefinition name="ToPage2"/>
</intermediateThrowEvent>

<intermediateCatchEvent id="CatchLink_1" name="æ¥è‡ªé¡µé¢ 1">
  <linkEventDefinition name="ToPage2"/>
</intermediateCatchEvent>
```

**è§„åˆ™**:
- âœ… å¿…é¡»æœ‰ incoming å’Œ outgoing sequence flow
- âœ… Catching Event: ç­‰å¾…äº‹ä»¶å‘ç”Ÿ
- âœ… Throwing Event: è§¦å‘äº‹ä»¶
- âœ… Link Event: name å¿…é¡»åŒ¹é…æ‰èƒ½è·³è½¬

#### 2.4 Boundary Event (è¾¹ç•Œäº‹ä»¶)

```xml
<task id="Task_ProcessPayment" name="å¤„ç†æ”¯ä»˜">
  <!-- Task å†…å®¹ -->
</task>

<!-- Timer Boundary Event (Non-Interrupting) -->
<boundaryEvent id="BoundaryEvent_Reminder" name="2å°æ—¶æé†’"
               attachedToRef="Task_ProcessPayment" cancelActivity="false">
  <timerEventDefinition>
    <timeDuration>PT2H</timeDuration>
  </timerEventDefinition>
</boundaryEvent>

<!-- Error Boundary Event (Interrupting) -->
<boundaryEvent id="BoundaryEvent_Error" name="æ”¯ä»˜å¤±è´¥"
               attachedToRef="Task_ProcessPayment" cancelActivity="true">
  <errorEventDefinition errorRef="Error_PaymentFailed"/>
</boundaryEvent>

<!-- Message Boundary Event -->
<boundaryEvent id="BoundaryEvent_Cancel" name="å–æ¶ˆè®¢å•"
               attachedToRef="Task_ProcessPayment" cancelActivity="true">
  <messageEventDefinition messageRef="Message_CancelOrder"/>
</boundaryEvent>
```

**è§„åˆ™**:
- âœ… å¿…é¡»ç”¨ `attachedToRef` é™„åŠ åˆ° Activity
- âœ… `cancelActivity="true"`: ä¸­æ–­å‹ (ä¸­æ–­æ´»åŠ¨)
- âœ… `cancelActivity="false"`: éä¸­æ–­å‹ (å¹¶è¡Œæ‰§è¡Œ)
- âœ… Error Event åªèƒ½æ˜¯ä¸­æ–­å‹
- âœ… ä¸èƒ½æœ‰ incoming sequence flow

### 3. Activity è§„åˆ™

#### 3.1 Task Types (ä»»åŠ¡ç±»å‹)

```xml
<!-- User Task -->
<userTask id="Task_ReviewDocument" name="å®¡æ ¸æ–‡æ¡£">
  <documentation>è¯·å®¡æ ¸å¹¶æ‰¹å‡†æ–‡æ¡£</documentation>
</userTask>

<!-- Service Task -->
<serviceTask id="Task_CallAPI" name="è°ƒç”¨ API">
  <extensionElements>
    <camunda:connector>
      <camunda:inputOutput>
        <camunda:inputParameter name="url">https://api.example.com</camunda:inputParameter>
        <camunda:inputParameter name="method">POST</camunda:inputParameter>
      </camunda:inputOutput>
    </camunda:connector>
  </extensionElements>
</serviceTask>

<!-- Send Task -->
<sendTask id="Task_SendEmail" name="å‘é€é‚®ä»¶">
  <messageEventDefinition messageRef="Message_Email"/>
</sendTask>

<!-- Receive Task -->
<receiveTask id="Task_WaitForResponse" name="ç­‰å¾…å“åº”">
  <messageEventDefinition messageRef="Message_Response"/>
</receiveTask>

<!-- Script Task -->
<scriptTask id="Task_Calculate" name="è®¡ç®—æ€»é¢" scriptFormat="javascript">
  <script>
    <![CDATA[
      var total = price * quantity;
      execution.setVariable('total', total);
    ]]>
  </script>
</scriptTask>

<!-- Manual Task -->
<manualTask id="Task_PhysicalInspection" name="ç°åœºæ£€æŸ¥"/>

<!-- Business Rule Task -->
<businessRuleTask id="Task_CreditCheck" name="ä¿¡ç”¨è¯„åˆ†">
  <extensionElements>
    <camunda:decisionRef>Decision_CreditScore</camunda:decisionRef>
  </extensionElements>
</businessRuleTask>
```

#### 3.2 Sub-Process (å­æµç¨‹)

**Embedded Sub-Process (åµŒå…¥å¼)**:
```xml
<subProcess id="SubProcess_OrderValidation" name="è®¢å•éªŒè¯">
  <startEvent id="StartEvent_Sub1"/>
  <task id="Task_CheckInventory" name="æ£€æŸ¥åº“å­˜"/>
  <task id="Task_ValidatePayment" name="éªŒè¯æ”¯ä»˜"/>
  <endEvent id="EndEvent_Sub1"/>

  <sequenceFlow id="Flow_Sub1" sourceRef="StartEvent_Sub1" targetRef="Task_CheckInventory"/>
  <sequenceFlow id="Flow_Sub2" sourceRef="Task_CheckInventory" targetRef="Task_ValidatePayment"/>
  <sequenceFlow id="Flow_Sub3" sourceRef="Task_ValidatePayment" targetRef="EndEvent_Sub1"/>
</subProcess>
```

**Call Activity (è°ƒç”¨æ´»åŠ¨)**:
```xml
<!-- å¯é‡ç”¨çš„æµç¨‹ -->
<process id="Process_EmailNotification">
  <startEvent id="Start"/>
  <task id="Task_Send" name="å‘é€é‚®ä»¶"/>
  <endEvent id="End"/>
</process>

<!-- è°ƒç”¨æ´»åŠ¨ -->
<callActivity id="CallActivity_Notify" name="å‘é€é€šçŸ¥" calledElement="Process_EmailNotification">
  <extensionElements>
    <camunda:in source="email" target="recipientEmail"/>
    <camunda:out source="status" target="notificationStatus"/>
  </extensionElements>
</callActivity>
```

**Multi-Instance (å¤šå®ä¾‹)**:
```xml
<!-- Parallel Multi-Instance -->
<userTask id="Task_Review" name="å¹¶è¡Œå®¡æ ¸">
  <multiInstanceLoopCharacteristics isSequential="false">
    <loopCardinality>3</loopCardinality>  <!-- 3ä¸ªå®ä¾‹ -->
    <completionCondition>${nrOfCompletedInstances >= 2}</completionCondition>  <!-- 2ä¸ªå®Œæˆå³å¯ -->
  </multiInstanceLoopCharacteristics>
</userTask>

<!-- Sequential Multi-Instance -->
<userTask id="Task_Approve" name="é¡ºåºå®¡æ‰¹">
  <multiInstanceLoopCharacteristics isSequential="true">
    <loopCardinality>${approvers.size()}</loopCardinality>
    <inputDataItem>approver</inputDataItem>
    <completionCondition>${approved == false}</completionCondition>  <!-- ä»»ä¸€æ‹’ç»åˆ™åœæ­¢ -->
  </multiInstanceLoopCharacteristics>
</userTask>
```

**Loop (æ ‡å‡†å¾ªç¯)**:
```xml
<task id="Task_RetryAPI" name="é‡è¯• API">
  <standardLoopCharacteristics testBefore="true">
    <loopCondition>${retryCount &lt; maxRetries}</loopCondition>
  </standardLoopCharacteristics>
</task>
```

### 4. Gateway è§„åˆ™

#### 4.1 Exclusive Gateway (XOR)

```xml
<exclusiveGateway id="Gateway_Decision" name="æ˜¯å¦æ‰¹å‡†?" default="Flow_Reject"/>

<!-- æ¡ä»¶åˆ†æ”¯ -->
<sequenceFlow id="Flow_Approve" name="æ˜¯" sourceRef="Gateway_Decision" targetRef="Task_Approve">
  <conditionExpression xsi:type="tFormalExpression">
    ${approved == true}
  </conditionExpression>
</sequenceFlow>

<!-- é»˜è®¤åˆ†æ”¯ (å…¶ä»–æƒ…å†µ) -->
<sequenceFlow id="Flow_Reject" name="å¦" sourceRef="Gateway_Decision" targetRef="Task_Reject"/>
```

**è§„åˆ™**:
- âœ… å¿…é¡»æŒ‡å®š `default` é»˜è®¤æµ
- âœ… å…¶ä»–æµå¿…é¡»æœ‰ `conditionExpression`
- âœ… åªæœ‰ä¸€æ¡æµä¼šè¢«æ¿€æ´»
- âœ… æ±‡èšæ—¶: ç­‰å¾…ä»»ä¸€åˆ†æ”¯åˆ°è¾¾

#### 4.2 Parallel Gateway (AND)

```xml
<!-- åˆ†æ”¯ -->
<parallelGateway id="Gateway_Fork" name="å¹¶è¡Œæ‰§è¡Œ"/>
<sequenceFlow sourceRef="Gateway_Fork" targetRef="Task_A"/>
<sequenceFlow sourceRef="Gateway_Fork" targetRef="Task_B"/>
<sequenceFlow sourceRef="Gateway_Fork" targetRef="Task_C"/>

<!-- æ±‡èš -->
<parallelGateway id="Gateway_Join" name="ç­‰å¾…æ‰€æœ‰"/>
<sequenceFlow sourceRef="Task_A" targetRef="Gateway_Join"/>
<sequenceFlow sourceRef="Task_B" targetRef="Gateway_Join"/>
<sequenceFlow sourceRef="Task_C" targetRef="Gateway_Join"/>
```

**è§„åˆ™**:
- âœ… åˆ†æ”¯: æ‰€æœ‰ outgoing flow åŒæ—¶æ¿€æ´»
- âœ… æ±‡èš: ç­‰å¾…æ‰€æœ‰ incoming flow åˆ°è¾¾
- âœ… ä¸éœ€è¦æ¡ä»¶è¡¨è¾¾å¼
- âœ… Fork å’Œ Join å¿…é¡»æˆå¯¹ä½¿ç”¨

#### 4.3 Inclusive Gateway (OR)

```xml
<inclusiveGateway id="Gateway_MultiChoice" name="é€‰æ‹©æœåŠ¡" default="Flow_Basic"/>

<sequenceFlow id="Flow_Premium" name="é«˜çº§æœåŠ¡" sourceRef="Gateway_MultiChoice" targetRef="Task_Premium">
  <conditionExpression>${premiumSelected == true}</conditionExpression>
</sequenceFlow>

<sequenceFlow id="Flow_Standard" name="æ ‡å‡†æœåŠ¡" sourceRef="Gateway_MultiChoice" targetRef="Task_Standard">
  <conditionExpression>${standardSelected == true}</conditionExpression>
</sequenceFlow>

<sequenceFlow id="Flow_Basic" name="åŸºç¡€æœåŠ¡" sourceRef="Gateway_MultiChoice" targetRef="Task_Basic"/>

<!-- æ±‡èš -->
<inclusiveGateway id="Gateway_Merge" name="æ±‡æ€»"/>
<sequenceFlow sourceRef="Task_Premium" targetRef="Gateway_Merge"/>
<sequenceFlow sourceRef="Task_Standard" targetRef="Gateway_Merge"/>
<sequenceFlow sourceRef="Task_Basic" targetRef="Gateway_Merge"/>
```

**è§„åˆ™**:
- âœ… å¯ä»¥æ¿€æ´»ä¸€æ¡æˆ–å¤šæ¡æµ
- âœ… å¿…é¡»æœ‰ `default` é»˜è®¤æµ
- âœ… å…¶ä»–æµå¿…é¡»æœ‰æ¡ä»¶è¡¨è¾¾å¼
- âœ… æ±‡èšæ—¶: ç­‰å¾…æ‰€æœ‰è¢«æ¿€æ´»çš„åˆ†æ”¯

#### 4.4 Event-Based Gateway (äº‹ä»¶ç½‘å…³)

```xml
<eventBasedGateway id="Gateway_Event" name="ç­‰å¾…äº‹ä»¶"/>

<!-- ç­‰å¾…æ¶ˆæ¯æˆ–è¶…æ—¶ -->
<intermediateCatchEvent id="Event_Message" name="æ”¶åˆ°æ¶ˆæ¯">
  <messageEventDefinition messageRef="Message_Response"/>
</intermediateCatchEvent>

<intermediateCatchEvent id="Event_Timeout" name="2å°æ—¶è¶…æ—¶">
  <timerEventDefinition>
    <timeDuration>PT2H</timeDuration>
  </timerEventDefinition>
</intermediateCatchEvent>

<sequenceFlow sourceRef="Gateway_Event" targetRef="Event_Message"/>
<sequenceFlow sourceRef="Gateway_Event" targetRef="Event_Timeout"/>
```

**è§„åˆ™**:
- âœ… outgoing flow å¿…é¡»æŒ‡å‘ Intermediate Catch Event æˆ– Receive Task
- âœ… ç¬¬ä¸€ä¸ªåˆ°è¾¾çš„äº‹ä»¶æ¿€æ´»å¯¹åº”æµç¨‹
- âœ… å…¶ä»–åˆ†æ”¯è¢«å–æ¶ˆ
- âœ… ä¸èƒ½æœ‰æ¡ä»¶è¡¨è¾¾å¼

#### 4.5 Complex Gateway (å¤æ‚ç½‘å…³)

```xml
<complexGateway id="Gateway_Complex" name="å¤æ‚é€»è¾‘">
  <activationCondition>
    ${(route1Complete &amp;&amp; route2Complete) || route3Complete}
  </activationCondition>
</complexGateway>
```

### 5. è¿æ¥å¯¹è±¡è§„åˆ™

#### 5.1 Sequence Flow (é¡ºåºæµ)

```xml
<!-- åŸºæœ¬é¡ºåºæµ -->
<sequenceFlow id="Flow_1" sourceRef="Task_1" targetRef="Task_2"/>

<!-- å¸¦åç§° -->
<sequenceFlow id="Flow_2" name="æ‰¹å‡†" sourceRef="Gateway_1" targetRef="Task_Approve"/>

<!-- å¸¦æ¡ä»¶ -->
<sequenceFlow id="Flow_3" name="é‡‘é¢ > 1000" sourceRef="Gateway_1" targetRef="Task_Review">
  <conditionExpression xsi:type="tFormalExpression">
    ${amount > 1000}
  </conditionExpression>
</sequenceFlow>

<!-- é»˜è®¤æµ -->
<exclusiveGateway id="Gateway_1" default="Flow_Default"/>
<sequenceFlow id="Flow_Default" sourceRef="Gateway_1" targetRef="Task_Default"/>
```

**è§„åˆ™**:
- âœ… åªèƒ½åœ¨åŒä¸€ä¸ª Pool å†…éƒ¨
- âœ… ä¸èƒ½è·¨è¶Š Pool è¾¹ç•Œ
- âœ… æ¡ä»¶è¡¨è¾¾å¼æ”¯æŒ: `${expression}` æˆ–è„šæœ¬

#### 5.2 Message Flow (æ¶ˆæ¯æµ)

```xml
<!-- å®šä¹‰æ¶ˆæ¯ -->
<message id="Message_OrderRequest" name="è®¢å•è¯·æ±‚"/>
<message id="Message_OrderConfirmation" name="è®¢å•ç¡®è®¤"/>

<!-- Pool A å‘é€æ¶ˆæ¯ -->
<sendTask id="Task_SendOrder" name="å‘é€è®¢å•">
  <messageEventDefinition messageRef="Message_OrderRequest"/>
</sendTask>

<!-- Pool B æ¥æ”¶æ¶ˆæ¯ -->
<receiveTask id="Task_ReceiveOrder" name="æ¥æ”¶è®¢å•">
  <messageEventDefinition messageRef="Message_OrderRequest"/>
</receiveTask>

<!-- æ¶ˆæ¯æµè¿æ¥ -->
<messageFlow id="MessageFlow_1" sourceRef="Task_SendOrder" targetRef="Task_ReceiveOrder"/>
```

**è§„åˆ™**:
- âœ… åªèƒ½åœ¨ä¸åŒ Pool ä¹‹é—´
- âœ… ä¸èƒ½åœ¨åŒä¸€ä¸ª Pool å†…éƒ¨
- âœ… å¿…é¡»å¼•ç”¨ Message å®šä¹‰
- âœ… å¯ä»¥è¿æ¥åˆ°: Message Event, Send/Receive Task, Pool è¾¹ç•Œ

#### 5.3 Association (å…³è”)

```xml
<!-- æ•°æ®å¯¹è±¡å…³è” -->
<dataObjectReference id="DataObject_Order" name="è®¢å•æ•°æ®" dataObjectRef="DataObject_1"/>

<task id="Task_ProcessOrder" name="å¤„ç†è®¢å•"/>

<dataInputAssociation id="Association_1">
  <sourceRef>DataObject_Order</sourceRef>
  <targetRef>Task_ProcessOrder</targetRef>
</dataInputAssociation>

<!-- æ–‡æœ¬æ³¨é‡Šå…³è” -->
<textAnnotation id="TextAnnotation_1">
  <text>æ­¤ä»»åŠ¡éœ€è¦ 2-3 å¤©å®Œæˆ</text>
</textAnnotation>

<association id="Association_2" sourceRef="Task_ProcessOrder" targetRef="TextAnnotation_1"/>
```

### 6. Swimlane è§„åˆ™

#### 6.1 Pool (æ± )

```xml
<collaboration id="Collaboration_1">
  <!-- Pool 1 -->
  <participant id="Participant_Customer" name="å®¢æˆ·" processRef="Process_Customer"/>

  <!-- Pool 2 -->
  <participant id="Participant_System" name="ç³»ç»Ÿ" processRef="Process_System"/>

  <!-- Black Box Pool (ä¸æ˜¾ç¤ºå†…éƒ¨æµç¨‹) -->
  <participant id="Participant_ExternalAPI" name="å¤–éƒ¨ API"/>

  <!-- æ¶ˆæ¯æµ -->
  <messageFlow id="MessageFlow_1" sourceRef="Task_SendRequest" targetRef="Participant_ExternalAPI"/>
</collaboration>

<process id="Process_Customer" isExecutable="false">
  <task id="Task_SendRequest" name="å‘é€è¯·æ±‚"/>
</process>

<process id="Process_System" isExecutable="false">
  <task id="Task_ProcessRequest" name="å¤„ç†è¯·æ±‚"/>
</process>
```

**è§„åˆ™**:
- âœ… ä»£è¡¨ä¸€ä¸ªå‚ä¸è€… (ç»„ç»‡ã€ç³»ç»Ÿã€è§’è‰²)
- âœ… å¿…é¡»é€šè¿‡ `processRef` å¼•ç”¨ Process
- âœ… Black Box Pool: ä¸æŒ‡å®š `processRef`
- âœ… Pool ä¹‹é—´ç”¨ Message Flow è¿æ¥

#### 6.2 Lane (æ³³é“)

```xml
<process id="Process_OrderFulfillment">
  <laneSet id="LaneSet_1">
    <!-- é”€å”®éƒ¨é—¨ -->
    <lane id="Lane_Sales" name="é”€å”®éƒ¨">
      <flowNodeRef>Task_CreateOrder</flowNodeRef>
      <flowNodeRef>Task_SendInvoice</flowNodeRef>
    </lane>

    <!-- ä»“åº“éƒ¨é—¨ -->
    <lane id="Lane_Warehouse" name="ä»“åº“">
      <flowNodeRef>Task_PickItems</flowNodeRef>
      <flowNodeRef>Task_PackOrder</flowNodeRef>
    </lane>

    <!-- ç‰©æµéƒ¨é—¨ -->
    <lane id="Lane_Shipping" name="ç‰©æµ">
      <flowNodeRef>Task_ShipOrder</flowNodeRef>
    </lane>
  </laneSet>

  <!-- Flow Objects -->
  <task id="Task_CreateOrder" name="åˆ›å»ºè®¢å•"/>
  <task id="Task_PickItems" name="æ‹£è´§"/>
  <task id="Task_PackOrder" name="æ‰“åŒ…"/>
  <task id="Task_ShipOrder" name="å‘è´§"/>
  <task id="Task_SendInvoice" name="å‘é€å‘ç¥¨"/>
</process>
```

**è§„åˆ™**:
- âœ… Lane å¿…é¡»åœ¨ LaneSet ä¸­å®šä¹‰
- âœ… ç”¨ `flowNodeRef` æŒ‡å®šåŒ…å«çš„ Flow Objects
- âœ… Lane å¯ä»¥åµŒå¥— (Sub-Lane)
- âœ… ä¸€ä¸ª Flow Object åªèƒ½å±äºä¸€ä¸ª Lane

### 7. æ•°æ®å¯¹è±¡è§„åˆ™

```xml
<!-- æ•°æ®å¯¹è±¡å®šä¹‰ -->
<dataObject id="DataObject_1"/>

<!-- æ•°æ®å¯¹è±¡å¼•ç”¨ -->
<dataObjectReference id="DataObject_Order" name="è®¢å•" dataObjectRef="DataObject_1"/>

<!-- æ•°æ®é›†åˆ -->
<dataObjectReference id="DataObject_Orders" name="è®¢å•åˆ—è¡¨" dataObjectRef="DataObject_1">
  <dataState name="å·²æäº¤"/>
</dataObjectReference>

<!-- æ•°æ®å­˜å‚¨ -->
<dataStoreReference id="DataStore_Database" name="è®¢å•æ•°æ®åº“"/>

<!-- æ•°æ®è¾“å…¥å…³è” -->
<task id="Task_1" name="ä»»åŠ¡1"/>
<dataInputAssociation>
  <sourceRef>DataObject_Order</sourceRef>
  <targetRef>Task_1</targetRef>
</dataInputAssociation>

<!-- æ•°æ®è¾“å‡ºå…³è” -->
<dataOutputAssociation>
  <sourceRef>Task_1</sourceRef>
  <targetRef>DataObject_Order</targetRef>
</dataOutputAssociation>
```

---

## ğŸ“ å›¾å½¢è§„åˆ™ (BPMN DI)

### 1. å½¢çŠ¶å®šä¹‰

```xml
<bpmndi:BPMNShape id="Shape_Task_1" bpmnElement="Task_1">
  <dc:Bounds x="200" y="100" width="100" height="80"/>
  <bpmndi:BPMNLabel>
    <dc:Bounds x="220" y="120" width="60" height="20"/>
  </bpmndi:BPMNLabel>
</bpmndi:BPMNShape>
```

**æ ‡å‡†å°ºå¯¸**:
- Task / Sub-Process: 100x80
- Event (Start/End): 36x36
- Intermediate Event: 36x36
- Gateway: 50x50
- Pool: ä»»æ„å®½åº¦, æœ€å°é«˜åº¦ 150
- Lane: ç»§æ‰¿ Pool å®½åº¦, é«˜åº¦å¯å˜

### 2. è¾¹å®šä¹‰

```xml
<bpmndi:BPMNEdge id="Edge_Flow_1" bpmnElement="Flow_1">
  <di:waypoint x="150" y="140"/>
  <di:waypoint x="200" y="140"/>
  <bpmndi:BPMNLabel>
    <dc:Bounds x="165" y="125" width="20" height="14"/>
  </bpmndi:BPMNLabel>
</bpmndi:BPMNEdge>
```

**è§„åˆ™**:
- `waypoint`: è‡³å°‘ 2 ä¸ªç‚¹ (èµ·ç‚¹å’Œç»ˆç‚¹)
- å¯ä»¥æœ‰å¤šä¸ªä¸­é—´ç‚¹å®šä¹‰æŠ˜çº¿
- `BPMNLabel`: å¯é€‰ï¼Œå®šä¹‰æ ‡ç­¾ä½ç½®

---

## ğŸ“‹ éªŒè¯è§„åˆ™æ£€æŸ¥æ¸…å•

### å¿…é¡»éµå®ˆ

- [ ] æ‰€æœ‰ ID å”¯ä¸€
- [ ] Start Event æ—  incoming flow
- [ ] End Event æ—  outgoing flow
- [ ] Gateway æœ‰å¤šä¸ª outgoing/incoming
- [ ] Exclusive/Inclusive Gateway æœ‰ default flow
- [ ] Message Flow ä»…åœ¨ä¸åŒ Pool é—´
- [ ] Sequence Flow ä»…åœ¨åŒä¸€ Pool å†…
- [ ] Boundary Event é™„åŠ åˆ° Activity
- [ ] flowNodeRef å¼•ç”¨çš„å…ƒç´ å­˜åœ¨
- [ ] bpmnElement å¼•ç”¨çš„å…ƒç´ å­˜åœ¨

### æ¨èåšæ³•

- [ ] ä¸ºæ‰€æœ‰å…ƒç´ æ·»åŠ  name å±æ€§
- [ ] ä½¿ç”¨æ¸…æ™°çš„ ID å‘½åè§„åˆ™
- [ ] æ·»åŠ  documentation å…ƒç´ 
- [ ] ä½¿ç”¨ Text Annotation æ·»åŠ è¯´æ˜
- [ ] åˆç†åˆ’åˆ† Lane å’Œ Pool
- [ ] å¤æ‚æµç¨‹ä½¿ç”¨ Sub-Process

---

**æ–‡æ¡£æ›´æ–°**: 2025-10-13
**å‚è€ƒæ¥æº**: OMG BPMN 2.0 Specification, bpmn.io Documentation
