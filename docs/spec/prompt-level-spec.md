DEPTH 框架映射

- Define Multiple Perspectives（D）：由 L1 提供常驻三专家角色声明（需求分析/图表设计/代码实现），L3 按图表类型补充 1-2 个专
  业子角色细化职责，最终拼接时改写成连续自然语言而非“层级标题”，确保模型只看到完整角色设定。
- Establish Success Metrics（E）：L1 固定通用合格标准（语法无误、结构清晰、中文标签等）；L2 增补语言级硬指标（保留字、转
  义、声明）；L3 补充类型必过项（例如流程图需显式起止节点）。终端提示中把三层指标合并成一段“必须满足的条件”句群，不暴露来源
  层级。
- Provide Context Layers（P）：保持三段内控描述而不直接投喂——L1 记录系统共性语境（例如服务 DiagramAI、默认语言等），L2 记录
  渲染语言背景（Mermaid/PlantUML 的版本或引擎限制），L3 记录图表特定语境（使用场景、常见业务限制）。交付时仅挑与当前请求相
  关的上下文，重写成 1 段自然描述。
- Task Breakdown（T）：L1 给出任务分流逻辑（生成/调整/修复的选择条件与执行要点），L3 根据类型补充执行步骤（如流程图先列节点
  再连线）。最后输出中把这些步骤转写成“工作流程”句子列表，不保留“L1/L3”标记。
- Human Feedback Loop（H）：统一由 L1 定义简化的自检流程（按语法、结构、需求匹配三维 ≥8 分则通过），L2/L3 仅在确有语言或类
  型特定复核项时追加。最终提示只呈现一段“自检指引”，避免出现层级称谓。

组合策略

- 维护内控模板：分别保有 L1/L2/L3 文本（控制在约 320、170、210 字左右），按 DEPTH 分段存储，便于局部更新。
- 拼接流程：按请求选定语言与类型 → 抽取 L1/L2/L3 相关段落 → 重写成无层级、顺畅的连续段落（角色→目标→上下文→任务→约束→自
  检），确认总字数与 token 在预算内。
- 输出检查：确保最终提示没有出现 “L1/L2/L3” 或分层说明，所有句子以命令式或陈述式呈现，让模型只看到统一提示。
