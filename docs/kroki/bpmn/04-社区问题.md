# BPMN ç¤¾åŒºé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

> **éªŒè¯æ—¶é—´**: 2025-10-13
> **æ•°æ®æ¥æº**: bpmn.io Forum, Camunda Forum, Stack Overflow

---

## ğŸ”¥ é«˜é¢‘é—®é¢˜æ±‡æ€»

### 1. å»ºæ¨¡åŸºç¡€é—®é¢˜

#### é—®é¢˜ 1.1: å¦‚ä½•é¿å…å¸¸è§å»ºæ¨¡é”™è¯¯?

**ç¤¾åŒºæ–‡ç« **: [Common BPMN Mistakes](https://flower-bpm.com/blog/common-bpmn-mistakes)

**æ ¸å¿ƒå»ºè®®**:

**Tip 1: å§‹ç»ˆå»ºæ¨¡ Start + End Event**
```xml
<!-- âŒ é¿å… -->
<process id="Process_1">
  <task id="Task_1" name="å¤„ç†ä»»åŠ¡"/>
</process>

<!-- âœ… æ¨è -->
<process id="Process_1">
  <startEvent id="Start" name="å¼€å§‹"/>
  <task id="Task_1" name="å¤„ç†ä»»åŠ¡"/>
  <endEvent id="End" name="ç»“æŸ"/>

  <sequenceFlow sourceRef="Start" targetRef="Task_1"/>
  <sequenceFlow sourceRef="Task_1" targetRef="End"/>
</process>
```

**Tip 2: é¿å… Activity æ”¾åœ¨ Lane ä¹‹é—´**
```xml
<!-- âŒ é—®é¢˜: Task_2 ä¸å±äºä»»ä½• Lane -->
<laneSet>
  <lane id="Lane_Sales">
    <flowNodeRef>Task_1</flowNodeRef>
  </lane>
  <lane id="Lane_Warehouse">
    <flowNodeRef>Task_3</flowNodeRef>
  </lane>
</laneSet>

<task id="Task_1"/>
<task id="Task_2"/>  <!-- å­¤ç«‹! -->
<task id="Task_3"/>

<!-- âœ… æ­£ç¡® -->
<laneSet>
  <lane id="Lane_Sales">
    <flowNodeRef>Task_1</flowNodeRef>
    <flowNodeRef>Task_2</flowNodeRef>
  </lane>
  <lane id="Lane_Warehouse">
    <flowNodeRef>Task_3</flowNodeRef>
  </lane>
</laneSet>
```

**Tip 3: ä½¿ç”¨æ¸…æ™°çš„äº‹ä»¶å‘½å**
```xml
<!-- âŒ ä¸æ¸…æ™° -->
<startEvent id="Start1" name="Start"/>
<endEvent id="End1" name="End"/>

<!-- âœ… æè¿°æ€§å‘½å -->
<startEvent id="StartEvent_OrderReceived" name="æ”¶åˆ°è®¢å•"/>
<endEvent id="EndEvent_OrderProcessed" name="è®¢å•å¤„ç†å®Œæˆ"/>
<endEvent id="EndEvent_OrderCancelled" name="è®¢å•å·²å–æ¶ˆ"/>
```

#### é—®é¢˜ 1.2: BPMN ç¬¦å·ä½¿ç”¨æ··æ·†

**LinkedIn æ–‡ç« **: [How to Avoid Common BPMN Modeling Mistakes](https://www.linkedin.com/advice/1/how-can-you-avoid-common-modeling-mistakes-bpmn)

**å¸¸è§æ··æ·†**:

**æ··æ·† 1: Task å›¾æ ‡ä¸æ¸…æ™°**
```
é—®é¢˜: æ‰€æœ‰ä»»åŠ¡éƒ½ç”¨æ™®é€š Task,çœ‹ä¸å‡ºç±»å‹

è§£å†³æ–¹æ¡ˆ:
- User Task (äººå·¥): ğŸ‘¤ å›¾æ ‡
- Service Task (API): âš™ï¸ å›¾æ ‡
- Send Task (å‘é€): âœ‰ï¸ å›¾æ ‡
- Receive Task (æ¥æ”¶): ğŸ“¥ å›¾æ ‡
- Script Task (è„šæœ¬): ğŸ“œ å›¾æ ‡
- Business Rule Task (è§„åˆ™): ğŸ“‹ å›¾æ ‡
- Manual Task (æ‰‹åŠ¨): ğŸ¤ å›¾æ ‡
```

**æ··æ·† 2: Gateway ç±»å‹é€‰æ‹©é”™è¯¯**
```
âŒ å¸¸è§é”™è¯¯:
- æƒ³è¦å¹¶è¡Œæ‰§è¡Œ,å´ç”¨äº† Exclusive Gateway
- æƒ³è¦äº’æ–¥é€‰æ‹©,å´ç”¨äº† Parallel Gateway
- å¿˜è®°ä¸º Exclusive/Inclusive Gateway è®¾ç½®é»˜è®¤æµ

âœ… è®°å¿†æŠ€å·§:
- Exclusive (â—‡ X): e**X**clusive, åªé€‰ä¸€ä¸ª
- Inclusive (â—‡ O): **O**ne or more, ä¸€ä¸ªæˆ–å¤šä¸ª
- Parallel (â—‡ +): å…¨éƒ¨æ‰§è¡Œ,åƒæ•°å­¦çš„"+"
```

**æ··æ·† 3: Event ç±»å‹ä¸å½“**
```
âŒ å¸¸è§é”™è¯¯:
- ç”¨ Message Event æ›¿ä»£ Task
- æ··æ·† Catching å’Œ Throwing Event

âœ… æ­£ç¡®ä½¿ç”¨:
- Catching Event (ç©ºå¿ƒ): ç­‰å¾…äº‹ä»¶å‘ç”Ÿ
- Throwing Event (å®å¿ƒ): è§¦å‘äº‹ä»¶
- Boundary Event: å¿…é¡»é™„åŠ åˆ° Activity
```

### 2. éªŒè¯é—®é¢˜

#### é—®é¢˜ 2.1: å¦‚ä½•è·å–éªŒè¯é”™è¯¯åˆ—è¡¨?

**è®ºå›è®¨è®º**: [Validation errors from bpmn-js-properties-panel](https://forum.bpmn.io/t/how-to-get-a-list-of-validation-errors/7867)

**è§£å†³æ–¹æ¡ˆ**:

```javascript
// æ–¹æ¡ˆ 1: ä½¿ç”¨ bpmn-js-bpmnlint
import BpmnModeler from 'bpmn-js/lib/Modeler';
import lintModule from 'bpmn-js-bpmnlint';

const modeler = new BpmnModeler({
  container: '#canvas',
  additionalModules: [lintModule]
});

await modeler.importXML(bpmnXML);

// è·å–æ‰€æœ‰é”™è¯¯
const linting = modeler.get('linting');
const issues = linting.getLinting();

Object.entries(issues).forEach(([elementId, reports]) => {
  reports.forEach(report => {
    console.log(`Element: ${elementId}`);
    console.log(`Rule: ${report.rule}`);
    console.log(`Message: ${report.message}`);
    console.log(`Severity: ${report.category}`); // error, warn
  });
});

// æ–¹æ¡ˆ 2: ä½¿ç”¨éªŒè¯å™¨
import { validateXML } from 'bpmn-moddle';

const { valid, errors } = await validateXML(bpmnXML);

if (!valid) {
  errors.forEach(err => {
    console.error(`Error: ${err.message}`);
    console.error(`Line: ${err.line}, Column: ${err.column}`);
  });
}
```

**å¸¸è§éªŒè¯è§„åˆ™**:
```javascript
{
  // ID å”¯ä¸€æ€§
  "no-duplicate-ids": "error",

  // Start/End Event
  "start-event-required": "error",
  "end-event-required": "error",

  // Gateway
  "exclusive-gateway-default-flow": "error",
  "gateway-fork-join-balance": "warn",

  // Boundary Event
  "boundary-event-attached": "error",

  // Message Flow
  "message-flow-cross-pool": "error"
}
```

#### é—®é¢˜ 2.2: Intermediate Error Event å¿…é¡»é™„åŠ åˆ° Activity

**Stack Overflow**: [Intermediate Error Event validation](https://learn.microsoft.com/en-us/answers/questions/5295246/intermediate-error-event-validation)

**é—®é¢˜**:
```xml
<!-- âŒ é”™è¯¯: Error Event æœªé™„åŠ  -->
<intermediateCatchEvent id="Event_Error">
  <errorEventDefinition/>
</intermediateCatchEvent>

é”™è¯¯æç¤º: "An intermediate Error Event must be attached to an Activity"
```

**è§£å†³æ–¹æ¡ˆ**:
```xml
<!-- âœ… æ–¹æ¡ˆ 1: é™„åŠ ä¸º Boundary Event -->
<task id="Task_ProcessPayment" name="å¤„ç†æ”¯ä»˜"/>

<boundaryEvent id="BoundaryEvent_Error"
               attachedToRef="Task_ProcessPayment"
               cancelActivity="true">
  <errorEventDefinition errorRef="Error_PaymentFailed"/>
</boundaryEvent>

<sequenceFlow sourceRef="BoundaryEvent_Error" targetRef="Task_HandleError"/>

<!-- âœ… æ–¹æ¡ˆ 2: ä½¿ç”¨ End Error Event -->
<task id="Task_Validate" name="éªŒè¯æ•°æ®"/>
<sequenceFlow sourceRef="Task_Validate" targetRef="EndEvent_Error">
  <conditionExpression>${validationFailed}</conditionExpression>
</sequenceFlow>

<endEvent id="EndEvent_Error" name="éªŒè¯å¤±è´¥">
  <errorEventDefinition errorRef="Error_ValidationFailed"/>
</endEvent>
```

**è§„åˆ™æ€»ç»“**:
- Intermediate Error Event: åªèƒ½ä½œä¸º Boundary Event
- Start Error Event: åªèƒ½åœ¨ Event Sub-Process ä¸­
- End Error Event: å¯åœ¨ä»»ä½•ä½ç½®

### 3. æ‰§è¡Œå¼•æ“é›†æˆé—®é¢˜

#### é—®é¢˜ 3.1: BPMN å»ºæ¨¡ vs æ‰§è¡Œ

**é—®é¢˜**: "æˆ‘çš„ BPMN å›¾åœ¨ Modeler ä¸­æ­£å¸¸ï¼Œä¸ºä»€ä¹ˆéƒ¨ç½²åˆ° Camunda å¤±è´¥?"

**åŸå› åˆ†æ**:

1. **å¯æ‰§è¡Œæ€§æ ‡è®°**
```xml
<!-- å»ºæ¨¡ç”¨ -->
<process id="Process_1" isExecutable="false">
  <!-- åªç”¨äºæ–‡æ¡£å’Œå¯è§†åŒ– -->
</process>

<!-- æ‰§è¡Œå¼•æ“ç”¨ -->
<process id="Process_1" isExecutable="true">
  <!-- éœ€è¦å®Œæ•´çš„æ‰§è¡Œè¯­ä¹‰ -->
</process>
```

2. **ç¼ºå°‘å®ç°ç»†èŠ‚**
```xml
<!-- âŒ å»ºæ¨¡: ç¼ºå°‘å®ç° -->
<serviceTask id="Task_CallAPI" name="è°ƒç”¨ API"/>

<!-- âœ… æ‰§è¡Œ: éœ€è¦å®ç° -->
<serviceTask id="Task_CallAPI" name="è°ƒç”¨ API"
             camunda:class="com.example.CallAPIDelegate"/>
<!-- æˆ– -->
<serviceTask id="Task_CallAPI" name="è°ƒç”¨ API"
             camunda:delegateExpression="${apiDelegate}"/>
<!-- æˆ– -->
<serviceTask id="Task_CallAPI" name="è°ƒç”¨ API">
  <extensionElements>
    <camunda:connector>
      <camunda:inputOutput>
        <camunda:inputParameter name="url">https://api.example.com</camunda:inputParameter>
      </camunda:inputOutput>
    </camunda:connector>
  </extensionElements>
</serviceTask>
```

3. **å˜é‡æœªå®šä¹‰**
```xml
<!-- âŒ æ¡ä»¶ä¸­ä½¿ç”¨æœªå®šä¹‰çš„å˜é‡ -->
<sequenceFlow sourceRef="Gateway_1" targetRef="Task_Approve">
  <conditionExpression>${approved == true}</conditionExpression>
  <!-- 'approved' å˜é‡ä»å“ªæ¥? -->
</sequenceFlow>

<!-- âœ… ç¡®ä¿å˜é‡åœ¨ä¹‹å‰è¢«è®¾ç½® -->
<userTask id="Task_Review" name="å®¡æ ¸">
  <extensionElements>
    <camunda:formData>
      <camunda:formField id="approved" type="boolean" label="æ˜¯å¦æ‰¹å‡†"/>
    </camunda:formData>
  </extensionElements>
</userTask>
```

#### é—®é¢˜ 3.2: ä¸åŒå¼•æ“çš„å…¼å®¹æ€§

**é—®é¢˜**: "BPMN åœ¨ Camunda èƒ½è¿è¡Œï¼Œä¸ºä»€ä¹ˆåœ¨ Flowable æŠ¥é”™?"

**åŸå› **: å¼•æ“ç‰¹å®šæ‰©å±•

```xml
<!-- Camunda æ‰©å±• -->
<serviceTask id="Task_1"
             camunda:class="com.example.MyDelegate"
             camunda:asyncBefore="true"/>

<!-- Flowable æ‰©å±• -->
<serviceTask id="Task_1"
             flowable:class="com.example.MyDelegate"
             flowable:async="true"/>

<!-- Activiti æ‰©å±• -->
<serviceTask id="Task_1"
             activiti:class="com.example.MyDelegate"
             activiti:async="true"/>
```

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨æ ‡å‡† BPMN æˆ–å¼•æ“æ— å…³çš„å®ç°

```xml
<!-- âœ… æ ‡å‡† BPMN (å¼•æ“æ— å…³) -->
<serviceTask id="Task_1" implementation="##WebService">
  <ioSpecification>
    <dataInput id="input1"/>
    <dataOutput id="output1"/>
  </ioSpecification>
</serviceTask>

<!-- âœ… æˆ–ä½¿ç”¨è„šæœ¬ (å¤§å¤šæ•°å¼•æ“æ”¯æŒ) -->
<scriptTask id="Task_1" scriptFormat="javascript">
  <script>
    execution.setVariable('result', 'value');
  </script>
</scriptTask>
```

### 4. æ€§èƒ½å’Œå¤æ‚åº¦é—®é¢˜

#### é—®é¢˜ 4.1: å¤§å‹æµç¨‹å›¾å¯è¯»æ€§å·®

**é—®é¢˜**: "æˆ‘çš„ BPMN å›¾æœ‰ 100+ ä¸ªå…ƒç´ ï¼Œå¤ªå¤æ‚äº†!"

**è§£å†³æ–¹æ¡ˆ**:

**æ–¹æ¡ˆ 1: åˆ†å±‚å»ºæ¨¡**
```
Level 1 (é«˜å±‚): ä¸»è¦ä¸šåŠ¡æµç¨‹
  â”œâ”€ Level 2 (ä¸­å±‚): è¯¦ç»†å­æµç¨‹
  â”‚   â””â”€ Level 3 (åº•å±‚): å®ç°ç»†èŠ‚

ç¤ºä¾‹:
- Level 1: è®¢å•å¤„ç†æµç¨‹ (5-10 ä¸ªæ´»åŠ¨)
  - Level 2: è®¢å•éªŒè¯å­æµç¨‹ (10-20 ä¸ªæ´»åŠ¨)
    - Level 3: åº“å­˜æ£€æŸ¥ç»†èŠ‚ (å…·ä½“å®ç°)
```

```xml
<!-- Level 1: é«˜å±‚æµç¨‹ -->
<process id="OrderProcess">
  <startEvent id="Start"/>
  <callActivity id="Call_Validate" calledElement="OrderValidationProcess"/>
  <callActivity id="Call_Fulfill" calledElement="OrderFulfillmentProcess"/>
  <endEvent id="End"/>
</process>

<!-- Level 2: å­æµç¨‹ -->
<process id="OrderValidationProcess">
  <startEvent id="Start_Val"/>
  <subProcess id="SubProcess_CheckInventory">
    <!-- Level 3 ç»†èŠ‚ -->
  </subProcess>
  <endEvent id="End_Val"/>
</process>
```

**æ–¹æ¡ˆ 2: ä½¿ç”¨ Collapsed Sub-Process**
```xml
<!-- æŠ˜å çš„å­æµç¨‹ (+ å·æ ‡è®°) -->
<subProcess id="SubProcess_1" name="è®¢å•éªŒè¯">
  <!-- å†…éƒ¨ç»†èŠ‚éšè— -->
  <startEvent id="Start_Sub"/>
  <task id="Task_CheckInventory" name="æ£€æŸ¥åº“å­˜"/>
  <task id="Task_ValidatePayment" name="éªŒè¯æ”¯ä»˜"/>
  <endEvent id="End_Sub"/>
</subProcess>
```

**æ–¹æ¡ˆ 3: åˆ†ç¦»å…³æ³¨ç‚¹**
```
ä¸è¦æŠŠæ‰€æœ‰é€»è¾‘æ”¾åœ¨ä¸€ä¸ªå›¾ä¸­,è€ƒè™‘æ‹†åˆ†:

1. æ­£å¸¸æµç¨‹ (Happy Path)
2. å¼‚å¸¸å¤„ç† (Error Handling) - ç”¨ Event Sub-Process
3. è¡¥å¿é€»è¾‘ (Compensation) - ç”¨ Compensation Event
```

```xml
<!-- ä¸»æµç¨‹: æ­£å¸¸è·¯å¾„ -->
<process id="MainProcess">
  <startEvent id="Start"/>
  <task id="Task_Process" name="å¤„ç†è®¢å•"/>
  <endEvent id="End_Success"/>
</process>

<!-- Event Sub-Process: å¼‚å¸¸å¤„ç† -->
<subProcess id="EventSubProcess_ErrorHandling" triggeredByEvent="true">
  <startEvent id="Start_Error">
    <errorEventDefinition errorRef="Error_ProcessingFailed"/>
  </startEvent>
  <task id="Task_HandleError" name="å¤„ç†é”™è¯¯"/>
  <endEvent id="End_Error"/>
</subProcess>
```

#### é—®é¢˜ 4.2: æµç¨‹æ‰§è¡Œæ€§èƒ½é—®é¢˜

**é—®é¢˜**: "æµç¨‹æœ‰å¾ˆå¤šå¹¶è¡Œåˆ†æ”¯ï¼Œæ‰§è¡Œå¾ˆæ…¢"

**æ€§èƒ½ä¼˜åŒ–å»ºè®®**:

1. **å‡å°‘ä¸å¿…è¦çš„å¹¶è¡Œåˆ†æ”¯**
```xml
<!-- âŒ è¿‡åº¦å¹¶è¡Œ -->
<parallelGateway id="Fork"/>
<sequenceFlow sourceRef="Fork" targetRef="Task_A"/>
<sequenceFlow sourceRef="Fork" targetRef="Task_B"/>
<sequenceFlow sourceRef="Fork" targetRef="Task_C"/>
<sequenceFlow sourceRef="Fork" targetRef="Task_D"/>
<sequenceFlow sourceRef="Fork" targetRef="Task_E"/>
<!-- 5 ä¸ªå¹¶è¡Œä»»åŠ¡,å¯èƒ½èµ„æºäº‰æŠ¢ -->

<!-- âœ… åˆç†åˆ†ç»„ -->
<parallelGateway id="Fork"/>
<sequenceFlow sourceRef="Fork" targetRef="SubProcess_Group1"/>
<sequenceFlow sourceRef="Fork" targetRef="SubProcess_Group2"/>
<!-- 2 ä¸ªå­æµç¨‹,å†…éƒ¨é¡ºåºæ‰§è¡Œ -->
```

2. **ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œ**
```xml
<!-- Camunda å¼‚æ­¥ -->
<serviceTask id="Task_LongRunning"
             camunda:asyncBefore="true"
             camunda:exclusive="false"/>

<!-- é¿å…é˜»å¡ä¸»æµç¨‹ -->
```

3. **ä¼˜åŒ– Gateway ä½¿ç”¨**
```xml
<!-- âŒ é¿å…: å¤æ‚çš„åµŒå¥— Gateway -->
<exclusiveGateway id="G1"/>
  <sequenceFlow targetRef="G2"/>
    <exclusiveGateway id="G2"/>
      <sequenceFlow targetRef="G3"/>
        <!-- å¤ªå¤šå±‚çº§ -->

<!-- âœ… æ¨è: æ‰å¹³åŒ–é€»è¾‘ -->
<exclusiveGateway id="Gateway_Main"/>
<sequenceFlow targetRef="Task_A">
  <conditionExpression>${condition1 &amp;&amp; condition2}</conditionExpression>
</sequenceFlow>
<!-- åˆå¹¶æ¡ä»¶,å‡å°‘åµŒå¥— -->
```

### 5. å·¥å…·å’Œåº“é›†æˆé—®é¢˜

#### é—®é¢˜ 5.1: bpmn-js è‡ªå®šä¹‰æ‰©å±•

**è®ºå›è®¨è®º**: [Custom properties in bpmn-js](https://forum.bpmn.io/t/custom-properties-extension)

**ç¤ºä¾‹: æ·»åŠ è‡ªå®šä¹‰å±æ€§**

```javascript
import BpmnModeler from 'bpmn-js/lib/Modeler';
import {
  BpmnPropertiesPanelModule,
  BpmnPropertiesProviderModule
} from 'bpmn-js-properties-panel';

// è‡ªå®šä¹‰å±æ€§æä¾›è€…
class CustomPropertiesProvider {
  constructor(propertiesPanel, translate) {
    propertiesPanel.registerProvider(500, this);
  }

  getGroups(element) {
    return (groups) => {
      // æ·»åŠ è‡ªå®šä¹‰åˆ†ç»„
      groups.push({
        id: 'custom',
        label: 'è‡ªå®šä¹‰å±æ€§',
        entries: [
          {
            id: 'priority',
            label: 'ä¼˜å…ˆçº§',
            modelProperty: 'priority',
            get: (element) => {
              return { priority: element.businessObject.priority || '' };
            },
            set: (element, values) => {
              return cmdHelper.updateBusinessObject(element, {
                priority: values.priority
              });
            }
          }
        ]
      });
      return groups;
    };
  }
}

// ä½¿ç”¨
const modeler = new BpmnModeler({
  container: '#canvas',
  additionalModules: [
    BpmnPropertiesPanelModule,
    BpmnPropertiesProviderModule,
    {
      __init__: ['customPropertiesProvider'],
      customPropertiesProvider: ['type', CustomPropertiesProvider]
    }
  ]
});
```

#### é—®é¢˜ 5.2: å¯¼å…¥å¯¼å‡º BPMN

**é—®é¢˜**: "å¯¼å…¥ BPMN XML åå›¾å½¢ä½ç½®ä¸¢å¤±"

**åŸå› **: ç¼ºå°‘ BPMN DI (Diagram Interchange) ä¿¡æ¯

```xml
<!-- âŒ åªæœ‰æµç¨‹å®šä¹‰,æ²¡æœ‰å›¾å½¢ -->
<definitions>
  <process id="Process_1">
    <startEvent id="Start"/>
    <task id="Task_1"/>
    <endEvent id="End"/>
  </process>
  <!-- ç¼ºå°‘ BPMNDiagram -->
</definitions>

<!-- âœ… å®Œæ•´çš„ BPMN (åŒ…å«å›¾å½¢) -->
<definitions>
  <process id="Process_1">
    <startEvent id="Start"/>
    <task id="Task_1"/>
    <endEvent id="End"/>
  </process>

  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="Shape_Start" bpmnElement="Start">
        <dc:Bounds x="150" y="100" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_1" bpmnElement="Task_1">
        <dc:Bounds x="250" y="80" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Edge_Flow_1" bpmnElement="Flow_1">
        <di:waypoint x="186" y="118"/>
        <di:waypoint x="250" y="120"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
```

**è§£å†³æ–¹æ¡ˆ: è‡ªåŠ¨å¸ƒå±€**
```javascript
import BpmnModeler from 'bpmn-js/lib/Modeler';

const modeler = new BpmnModeler({ container: '#canvas' });

// å¯¼å…¥ BPMN XML
await modeler.importXML(xmlWithoutDI);

// è‡ªåŠ¨å¸ƒå±€
const layouter = modeler.get('layouter');
const elementRegistry = modeler.get('elementRegistry');

const rootElement = elementRegistry.get('Process_1');
await layouter.layoutProcess(rootElement);

// å¯¼å‡ºå¸¦å›¾å½¢çš„ XML
const { xml } = await modeler.saveXML({ format: true });
```

### 6. å­¦ä¹ èµ„æºæ¨è

#### å®˜æ–¹èµ„æº

1. **OMG BPMN è§„èŒƒ**
   - å®Œæ•´è§„èŒƒ: https://www.omg.org/spec/BPMN/2.0/
   - å¿«é€ŸæŒ‡å—: https://www.omg.org/bpmn/Documents/BPMN_Quick_Guide.pdf

2. **bpmn.io æ–‡æ¡£**
   - å®˜æ–¹æ–‡æ¡£: https://bpmn.io/toolkit/bpmn-js/
   - ç¤ºä¾‹: https://github.com/bpmn-io/bpmn-js-examples

3. **Camunda å­¦ä¹ **
   - BPMN æ•™ç¨‹: https://camunda.com/bpmn/
   - æœ€ä½³å®è·µ: https://camunda.com/best-practices/

#### ç¤¾åŒºèµ„æº

1. **è®ºå›**
   - bpmn.io Forum: https://forum.bpmn.io/
   - Camunda Forum: https://forum.camunda.io/
   - Stack Overflow: `[bpmn]` æ ‡ç­¾

2. **åšå®¢å’Œæ–‡ç« **
   - Heflo BPMN Guide: https://www.heflo.com/blog/bpmn-notation/
   - Flower BPM Blog: https://flower-bpm.com/blog/

3. **è§†é¢‘æ•™ç¨‹**
   - YouTube: "BPMN Tutorial"
   - Camunda Academy: https://academy.camunda.com/

#### å®è·µé¡¹ç›®

1. **å¼€æºç¤ºä¾‹**
   - Camunda Examples: https://github.com/camunda/camunda-bpm-examples
   - Flowable Examples: https://github.com/flowable/flowable-examples

2. **åœ¨çº¿ç»ƒä¹ **
   - BPMN Simulator: https://demo.bpmn.io/
   - BPMN Quiz: https://www.bpmnquiz.com/

---

## ğŸ“Š å¸¸è§é—®é¢˜ç»Ÿè®¡

åŸºäºç¤¾åŒºè®ºå›åˆ†æ (2024-2025):

| é—®é¢˜ç±»å‹ | å æ¯” | ä¸»è¦å›°æƒ‘ |
|---------|------|---------|
| Gateway ä½¿ç”¨ | 30% | ç±»å‹é€‰æ‹©ã€é»˜è®¤æµ |
| Event é…ç½® | 25% | Boundary Eventã€Timer è¯­æ³• |
| Message Flow | 20% | Pool é—´é€šä¿¡ã€æ¶ˆæ¯å®šä¹‰ |
| æ‰§è¡Œå¼•æ“é›†æˆ | 15% | å¯æ‰§è¡Œæ€§ã€å˜é‡ç®¡ç† |
| å·¥å…·ä½¿ç”¨ | 10% | bpmn-js æ‰©å±•ã€éªŒè¯ |

---

## ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“

### 1. å»ºæ¨¡åŸåˆ™

- âœ… å§‹ç»ˆæœ‰æ˜ç¡®çš„ Start å’Œ End Event
- âœ… ä½¿ç”¨æè¿°æ€§å‘½å (åŠ¨è¯+åè¯)
- âœ… åˆç†ä½¿ç”¨ Lane åˆ’åˆ†èŒè´£
- âœ… é¿å…è¿‡åº¦å¤æ‚çš„åµŒå¥—
- âœ… å¼‚å¸¸å¤„ç†ç”¨ Boundary Event

### 2. Gateway ä½¿ç”¨

- âœ… Exclusive Gateway å¿…é¡»æœ‰é»˜è®¤æµ
- âœ… Parallel Gateway æˆå¯¹ä½¿ç”¨ (Fork + Join)
- âœ… æ ¹æ®ä¸šåŠ¡é€»è¾‘é€‰æ‹©æ­£ç¡®ç±»å‹
- âœ… é¿å…ä¸å¿…è¦çš„å¹¶è¡Œåˆ†æ”¯

### 3. å¯ç»´æŠ¤æ€§

- âœ… ä½¿ç”¨ Sub-Process å°è£…å¤æ‚é€»è¾‘
- âœ… ä½¿ç”¨ Call Activity é‡ç”¨æµç¨‹
- âœ… æ·»åŠ æ–‡æ¡£å’Œæ³¨é‡Š
- âœ… å®šæœŸéªŒè¯å’Œæµ‹è¯•

### 4. æ€§èƒ½ä¼˜åŒ–

- âœ… åˆç†ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œ
- âœ… å‡å°‘ä¸å¿…è¦çš„ Gateway
- âœ… ä¼˜åŒ–å¹¶è¡Œåˆ†æ”¯æ•°é‡
- âœ… ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢

---

**æ–‡æ¡£æ›´æ–°**: 2025-10-13
**æ•°æ®æ¥æº**: bpmn.io Forum, Camunda Community, Stack Overflow, å®è·µç»éªŒæ€»ç»“
